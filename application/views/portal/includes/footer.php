</section>
<div class="footer_text">

    &nbsp;&nbsp; &copy; <?php echo date('Y').' '.PROJECT_TITLE; ?> . All rights
    reserved.
</div>
<div id="att_data_html" class="att_data_html hide"></div>
<!-- End main container -->

<!-- Placed js at the end of the document so the pages load faster -->
<!--Core js-->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
<!--<script src="<?/*=base_url('assets/assets/jquery-ui/jquery-ui-1.10.1.custom.min.js') ; */?>"></script>-->
<script src="<?php echo base_url('assets/bs3/js/bootstrap.min.js') ; ?>"></script>
<script src="<?php echo base_url('assets/js/accordion-menu/jquery.dcjqaccordion.2.7.js') ; ?>"></script>
<script src="<?php echo base_url('assets/js/scrollTo/jquery.scrollTo.min.js') ; ?>"></script>
<script src="<?php echo base_url('assets/js/nicescroll/jquery.nicescroll.js') ; ?>" type="text/javascript"></script>
<!--[if lte IE 8]><script language="javascript" type="text/javascript" src="<?php echo base_url('assets/js/flot-chart/excanvas.min.js');?>"></script><![endif]-->
<script src="<?php echo base_url('assets/assets/jQuery-slimScroll-1.3.0/jquery.slimscroll.js') ; ?>"></script>
<script src="<?php echo base_url('assets/assets/skycons/skycons.js') ; ?>"></script>
<script src="<?php echo base_url('assets/assets/jquery.scrollTo/jquery.scrollTo.js') ; ?>"></script>
<!--<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>-->
<script src="<?php echo base_url('assets/assets/calendar/clndr.js') ; ?>"></script>
<!--<script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js"></script>-->
<script src="<?php echo base_url('assets/assets/calendar/moment-2.2.1.js') ; ?>"></script>
<script src="<?php echo base_url('assets/js/calendar/evnt.calendar.init.js') ; ?>"></script>
<script src="<?php echo base_url('assets/assets/jvector-map/jquery-jvectormap-1.2.2.min.js') ; ?>"></script>
<script src="<?php echo base_url('assets/assets/jvector-map/jquery-jvectormap-us-lcc-en.js') ; ?>"></script>
<script src="<?php echo base_url('assets/assets/bootstrap-timepicker/js/bootstrap-timepicker.js') ; ?>"></script>
<script src="<?php echo base_url('assets/assets/bootstrap-datetimepicker/js/bootstrap-datetimepicker.js') ; ?>"></script>
<script src="<?php echo base_url('assets/js/typeahead.min.js') ; ?>"></script>
<!--<script src="<?/*=base_url('assets/assets/gauge/gauge.js') ; */?>"></script>-->
<!--Switch button js-->
<script src="<?php echo base_url('assets/assets/bootstrap-switch-master/build/js/bootstrap-switch.js') ; ?>"></script>
<!--clock init-->
<script src="<?php echo base_url('assets/assets/css3clock/js/script.js') ; ?>"></script>
<!--Easy Pie Chart-->
<script src="<?php echo base_url('assets/assets/easypiechart/jquery.easypiechart.js') ; ?>"></script>
<!--Sparkline Chart-->
<script src="<?php echo base_url('assets/assets/sparkline/jquery.sparkline.js') ; ?>"></script>
<!--Morris Chart-->
<script src="<?php echo base_url('assets/assets/morris-chart/morris.js') ; ?>"></script>
<script src="<?php echo base_url('assets/assets/morris-chart/raphael-min.js') ; ?>"></script>
<!--Chart JS-->
<script type="text/javascript" src="<?php echo base_url('assets/assets/chart-js/Chart.js') ; ?>"></script>
<!--<script type="text/javascript" src="<?/*=base_url('assets/js/chartjs/chartjs.init.js') ; */?>"></script>-->


<!--this page script-->
<!--<script src="<?/*=base_url('assets/js/jquery-validate/validation-init.js') ; */?>"></script>-->
<!--dynamic table initialization -->
<!--<script src="<?/*=base_url('assets/js/dynamic_table/dynamic_table_init.js') ; */?>"></script>-->
<!-- Data picker  -->
<script type="text/javascript" src="<?php echo base_url('assets/js/datapicker/datepicker.js') ; ?>"></script>
<!--form validation and confirm box -->
<script type="text/javascript" src="<?php echo  base_url('assets/js/plugins/forms/jquery.uniform.min.js'); ?>"></script>
<script type="text/javascript" src="<?php echo  base_url('assets/js/plugins/forms/jquery.tagsinput.min.js'); ?>"></script>

<script type="text/javascript" src="<?php echo  base_url('assets/js/plugins/forms/jquery.autosize.js'); ?>"></script>
<script type="text/javascript" src="<?php echo  base_url('assets/js/plugins/forms/jquery.inputlimiter.min.js'); ?>"></script>
<script type="text/javascript" src="<?php echo  base_url('assets/js/plugins/forms/jquery.inputmask.js'); ?>"></script>
<script type="text/javascript" src="<?php echo  base_url('assets/js/plugins/forms/jquery.select2.min.js'); ?>"></script>
<script type="text/javascript" src="<?php echo  base_url('assets/js/plugins/forms/jquery.listbox.js'); ?>"></script>
<!--jquery spinner-->
<script type="text/javascript" src="<?php echo  base_url('assets/assets/fuelux/js/spinner.min.js'); ?>"></script>
<script type="text/javascript" src="<?php echo  base_url('assets/js/plugins/forms/jquery.validation.js'); ?>"></script>
<script type="text/javascript" src="<?php echo  base_url('assets/js/plugins/forms/jquery.validationEngine-en.js'); ?>"></script>
<script type="text/javascript" src="<?php echo  base_url('assets/js/gritter/gritter.js'); ?>"></script>
<script src="<?php echo base_url('assets/assets/nestable/jquery.nestable.js') ; ?>"></script>


<script type="text/javascript" src="<?php echo base_url('assets/js/scripts.js') ; ?>"></script>
<!--tinymce -->
<script src="<?php echo base_url('assets/js/draggable-portlet/draggable-portlet.js') ; ?>"></script>

<script>

    jQuery(document).ready(function() {
        DraggablePortlet.init();
    });
</script>

<script type="text/javascript" src="<?php echo  base_url('assets/tiny_mce/tiny_mce.js'); ?>"></script>
<script type="text/javascript" src="<?php echo  base_url('assets/tiny_mce/tiny_mce_setting.js'); ?>"></script>

<script type="text/javascript" src="<?php echo base_url('assets/js/my_plugins.js');?>"></script>
<!--<script type="text/javascript">
    $(document).ready(function () {
        setInterval(function () {
            $.ajax({
                type: "POST",
                dataType: "JSON",
                url: "<?/*= site_url(ADMIN_DIR. '/dashboard/checkNewData'); */?>",
                data: {id: 1},
                complete: function (data) {
                    var json = $.parseJSON(data.responseText);
                    console.log(json);
                    if(json) {
                        console.log("in");
                        $.each(json, function (key, value) {
                            //console.log(key+"=>>>>>"+value.account_id);
                            $.gritter.add({
                                // (string | mandatory) the heading of the notification
                                title: 'Member '+value.account_name+' '+((value.check_type=="I")?"Checked In":"Checked Out"),
                                // (string | mandatory) the text inside the notification
                                text: 'Account id : '+value.account_id +' <br> Date Time: '+value.datetime+
                                        '<br> Fee Status : '+value.monthly_fee +'<br> Subscription : '+value.subscription_status,
                                class_name: ((value.check_type=="I")?"gritter-in":"gritter-out"),
                                sticky: true
                            });
                        });
                    }
                }
                });
        },4000);

    });
</script>

<script type="text/javascript">
    $(document).ready(function () {
        setInterval(function () {
            var client = new XMLHttpRequest();

            client.open('GET', '<?/*=ATTENDANCE_DATA_URL;*/?>');
            client.onreadystatechange = function() {
                document.getElementById("att_data_html").innerHTML = client.responseText;
                var json_string_value = client.responseText;

                $.ajax({
                    type: "POST",
                    data: "json_string=" + json_string_value,
                    url: "<?/*= site_url(ADMIN_DIR. '/dashboard/update_attendance_live'); */?>",
                    complete: function (data) {
                        console.log(data.responseText);
                    }
                });

            }
            client.send();
        },4000);

    });
</script>-->
<?php
if($this->session->userdata('user_info')->is_machine==1){
?>
<script type="text/javascript">
    function onBlur() {
        document.body.className = 'blurred';
    };
    function onFocus(){
        document.body.className = 'focused';
    };

    if (/*@cc_on!@*/false) { // check for Internet Explorer
        document.onfocusin = onFocus;
        document.onfocusout = onBlur;
    } else {
        window.onfocus = onFocus;
        window.onblur = onBlur;
    }
    $(document).ready(function () {

        setInterval(function () {
            if($('body').hasClass('blurred')) {
                return false;
            }
            var i = 1;
                var client = new XMLHttpRequest();

                client.open('GET', '<?=ATTENDANCE_DATA_URL;?>');
                client.onreadystatechange = function () {
                    document.getElementById("att_data_html").innerHTML = client.responseText;
                    
                    var json_string_value = client.responseText;
                    console.log(client.responseText.length);

                    if (client.responseText.length > 2 && i ==1 ) {
                        $.ajax({
                            type: "POST",
                            data: "json_string=" + json_string_value,
                            url: "<?= site_url(ADMIN_DIR . '/dashboard/update_attendance_live'); ?>",
                            complete: function (data) {
                                console.log(data.responseText);

                                var json = $.parseJSON(data.responseText);
                                if (json) {
                                    console.log("in");
                                    $.each(json, function (key, value) {
                                        //console.log(key+"=>>>>>"+value.account_id);
                                        if(value.is_valid_user==2){
                                            $.gritter.add({
                                                // (string | mandatory) the heading of the notification
                                                title: 'Member ' + value.account_name + ' ' + ((value.check_type == "I") ? "Checked In" : "Checked Out"),
                                                // (string | mandatory) the text inside the notification
                                                text: 'Member id : ' + value.account_id + ' <br> Date Time: ' + value.datetime +
                                                '<br> <strong>Warning!</strong><br>This member has already checked today.',
                                                class_name: "gritter-exist",
                                                sticky: true
                                            });
                                        }else
                                        {
                                            $.gritter.add({
                                                // (string | mandatory) the heading of the notification
                                                title: 'Member ' + value.account_name + ' ' + ((value.check_type == "I") ? "Checked In" : "Checked Out"),
                                                // (string | mandatory) the text inside the notification
                                                text: 'Member id : ' + value.account_id + ' <br> Date Time: ' + value.datetime +
                                                '<br> Fee Status : ' + value.monthly_fee + '<br> Subscription : ' + value.subscription_status +
                                                '<br> Unpaid Invoice : ' + value.unpaid_invoice ,
                                                class_name: ((value.check_type == "I") ? "gritter-in" : "gritter-out"),
                                                sticky: true
                                            });
                                        }
                                    });
                                }
                            }
                        });
                        i++;
                    }

                };
                client.send();

        },3000);

    });
</script>
<?php
}
?>
<!--<script type="text/javascript">
    $(document).ready(function () {
        setInterval(function () {
            var att_request = new XMLHttpRequest();
            att_request.open('GET', '<?/*=ATTENDANCE_DATA_URL;*/?>');
            att_request.onreadystatechange = function() {
                var json_string_value = client.responseText;
                $.ajax({
                    type: "POST",
                    dataType: "JSON",
                    url: "<?/*= site_url(ADMIN_DIR . '/dashboard/checkNewData'); */?>",
                    data: {machineAttendance: json_string_value},
                    complete: function (data) {
                        var json = $.parseJSON(data.responseText);
                        console.log(json);
                        if (json) {
                            console.log("in");
                            $.each(json, function (key, value) {
                                //console.log(key+"=>>>>>"+value.account_id);
                                $.gritter.add({
                                    // (string | mandatory) the heading of the notification
                                    title: 'Member ' + value.account_name + ' ' + ((value.check_type == "I") ? "Checked In" : "Checked Out"),
                                    // (string | mandatory) the text inside the notification
                                    text: 'Account id : ' + value.account_id + ' <br> Date Time: ' + value.datetime +
                                    '<br> Fee Status : ' + value.monthly_fee + '<br> Subscription : ' + value.subscription_status,
                                    class_name: ((value.check_type == "I") ? "gritter-in" : "gritter-out"),
                                    sticky: true
                                });
                            });
                        }
                    }
                });
            };
            att_request.send();
        },4000);

    });
</script>-->
</body>
</html>




